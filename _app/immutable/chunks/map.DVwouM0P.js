var de=Object.defineProperty;var j=r=>{throw TypeError(r)};var pe=(r,e,t)=>e in r?de(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var E=(r,e,t)=>pe(r,typeof e!="symbol"?e+"":e,t),ge=(r,e,t)=>e.has(r)||j("Cannot "+t);var P=(r,e,t)=>(ge(r,e,"read from private field"),t?t.call(r):e.get(r)),W=(r,e,t)=>e.has(r)?j("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{b as K,d as Ce,a as S,t as ve}from"./disclose-version.Bxlf7fDP.js";import{b as ye,h as F,B as ee,d as we,i as re,x as _e,D as ke,y as Ee,A as Te,w as De,g as Le,V as $e,ac as Ie,ad as he,R as $,P as _,p as xe,u as ze,a6 as te,k as Me,a7 as q,a9 as b,a8 as J}from"./runtime.BoDygLRA.js";import{p as me,i as Oe,b as ne}from"./this.BFAfeJ0Z.js";import{b as se}from"./paths.8_syT3yI.js";function Ae(r,e,t,s,a){var n=r,i="",u;ye(()=>{if(i===(i=e()??"")){F&&ee();return}u!==void 0&&(Le(u),u=void 0),i!==""&&(u=we(()=>{if(F){re.data;for(var o=ee(),f=o;o!==null&&(o.nodeType!==8||o.data!=="");)f=o,o=_e(o);if(o===null)throw ke(),Ee;K(re,f),n=Te(o);return}var l=i+"",c=Ce(l);K(De(c),c.lastChild),n.before(c)}))})}function ae(r,e,t,s){var a=r.__attributes??(r.__attributes={});if(F){a[e]=r.getAttribute(e);return}a[e]!==(a[e]=t)&&(t==null?r.removeAttribute(e):typeof t!="string"&&Ne(r).includes(e)?r[e]=t:r.setAttribute(e,t))}var ie=new Map;function Ne(r){var e=ie.get(r.nodeName);if(e)return e;ie.set(r.nodeName,e=[]);for(var t,s=r,a=Element.prototype;a!==s;){t=Ie(s);for(var n in t)t[n].set&&e.push(n);s=$e(s)}return e}function w(){}w.prototype={diff:function(e,t){var s,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=a.callback;typeof a=="function"&&(n=a,a={});var i=this;function u(h){return h=i.postProcess(h,a),n?(setTimeout(function(){n(h)},0),!0):h}e=this.castInput(e,a),t=this.castInput(t,a),e=this.removeEmpty(this.tokenize(e,a)),t=this.removeEmpty(this.tokenize(t,a));var o=t.length,f=e.length,l=1,c=o+f;a.maxEditLength!=null&&(c=Math.min(c,a.maxEditLength));var k=(s=a.timeout)!==null&&s!==void 0?s:1/0,p=Date.now()+k,d=[{oldPos:-1,lastComponent:void 0}],C=this.extractCommon(d[0],t,e,0,a);if(d[0].oldPos+1>=f&&C+1>=o)return u(oe(i,d[0].lastComponent,t,e,i.useLongestToken));var D=-1/0,m=1/0;function g(){for(var h=Math.max(D,-l);h<=Math.min(m,l);h+=2){var v=void 0,L=d[h-1],I=d[h+1];L&&(d[h-1]=void 0);var R=!1;if(I){var Q=I.oldPos-h;R=I&&0<=Q&&Q<o}var X=L&&L.oldPos+1<f;if(!R&&!X){d[h]=void 0;continue}if(!X||R&&L.oldPos<I.oldPos?v=i.addToPath(I,!0,!1,0,a):v=i.addToPath(L,!1,!0,1,a),C=i.extractCommon(v,t,e,h,a),v.oldPos+1>=f&&C+1>=o)return u(oe(i,v.lastComponent,t,e,i.useLongestToken));d[h]=v,v.oldPos+1>=f&&(m=Math.min(m,h-1)),C+1>=o&&(D=Math.max(D,h+1))}l++}if(n)(function h(){setTimeout(function(){if(l>c||Date.now()>p)return n();g()||h()},0)})();else for(;l<=c&&Date.now()<=p;){var y=g();if(y)return y}},addToPath:function(e,t,s,a,n){var i=e.lastComponent;return i&&!n.oneChangePerToken&&i.added===t&&i.removed===s?{oldPos:e.oldPos+a,lastComponent:{count:i.count+1,added:t,removed:s,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+a,lastComponent:{count:1,added:t,removed:s,previousComponent:i}}},extractCommon:function(e,t,s,a,n){for(var i=t.length,u=s.length,o=e.oldPos,f=o-a,l=0;f+1<i&&o+1<u&&this.equals(s[o+1],t[f+1],n);)f++,o++,l++,n.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return l&&!n.oneChangePerToken&&(e.lastComponent={count:l,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=o,f},equals:function(e,t,s){return s.comparator?s.comparator(e,t):e===t||s.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],s=0;s<e.length;s++)e[s]&&t.push(e[s]);return t},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function oe(r,e,t,s,a){for(var n=[],i;e;)n.push(e),i=e.previousComponent,delete e.previousComponent,e=i;n.reverse();for(var u=0,o=n.length,f=0,l=0;u<o;u++){var c=n[u];if(c.removed)c.value=r.join(s.slice(l,l+c.count)),l+=c.count;else{if(!c.added&&a){var k=t.slice(f,f+c.count);k=k.map(function(p,d){var C=s[l+d];return C.length>p.length?C:p}),c.value=r.join(k)}else c.value=r.join(t.slice(f,f+c.count));f+=c.count,c.added||(l+=c.count)}}return n}var Re=new w;function Pe(r,e,t){return Re.diff(r,e,t)}function ue(r,e){var t;for(t=0;t<r.length&&t<e.length;t++)if(r[t]!=e[t])return r.slice(0,t);return r.slice(0,t)}function fe(r,e){var t;if(!r||!e||r[r.length-1]!=e[e.length-1])return"";for(t=0;t<r.length&&t<e.length;t++)if(r[r.length-(t+1)]!=e[e.length-(t+1)])return r.slice(-t);return r.slice(-t)}function G(r,e,t){if(r.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return t+r.slice(e.length)}function H(r,e,t){if(!e)return r+t;if(r.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return r.slice(0,-e.length)+t}function x(r,e){return G(r,e,"")}function O(r,e){return H(r,e,"")}function le(r,e){return e.slice(0,qe(r,e))}function qe(r,e){var t=0;r.length>e.length&&(t=r.length-e.length);var s=e.length;r.length<e.length&&(s=r.length);var a=Array(s),n=0;a[0]=0;for(var i=1;i<s;i++){for(e[i]==e[n]?a[i]=a[n]:a[i]=n;n>0&&e[i]!=e[n];)n=a[n];e[i]==e[n]&&n++}n=0;for(var u=t;u<r.length;u++){for(;n>0&&r[u]!=e[n];)n=a[n];r[u]==e[n]&&n++}return n}var A="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",be=new RegExp("[".concat(A,"]+|\\s+|[^").concat(A,"]"),"ug"),N=new w;N.equals=function(r,e,t){return t.ignoreCase&&(r=r.toLowerCase(),e=e.toLowerCase()),r.trim()===e.trim()};N.tokenize=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(e.intlSegmenter.segment(r),function(n){return n.segment})}else t=r.match(be)||[];var s=[],a=null;return t.forEach(function(n){/\s/.test(n)?a==null?s.push(n):s.push(s.pop()+n):/\s/.test(a)?s[s.length-1]==a?s.push(s.pop()+n):s.push(a+n):s.push(n),a=n}),s};N.join=function(r){return r.map(function(e,t){return t==0?e:e.replace(/^\s+/,"")}).join("")};N.postProcess=function(r,e){if(!r||e.oneChangePerToken)return r;var t=null,s=null,a=null;return r.forEach(function(n){n.added?s=n:n.removed?a=n:((s||a)&&ce(t,a,s,n),t=n,s=null,a=null)}),(s||a)&&ce(t,a,s,null),r};function ce(r,e,t,s){if(e&&t){var a=e.value.match(/^\s*/)[0],n=e.value.match(/\s*$/)[0],i=t.value.match(/^\s*/)[0],u=t.value.match(/\s*$/)[0];if(r){var o=ue(a,i);r.value=H(r.value,i,o),e.value=x(e.value,o),t.value=x(t.value,o)}if(s){var f=fe(n,u);s.value=G(s.value,u,f),e.value=O(e.value,f),t.value=O(t.value,f)}}else if(t)r&&(t.value=t.value.replace(/^\s*/,"")),s&&(s.value=s.value.replace(/^\s*/,""));else if(r&&s){var l=s.value.match(/^\s*/)[0],c=e.value.match(/^\s*/)[0],k=e.value.match(/\s*$/)[0],p=ue(l,c);e.value=x(e.value,p);var d=fe(x(l,p),k);e.value=O(e.value,d),s.value=G(s.value,l,d),r.value=H(r.value,l,l.slice(0,l.length-d.length))}else if(s){var C=s.value.match(/^\s*/)[0],D=e.value.match(/\s*$/)[0],m=le(D,C);e.value=O(e.value,m)}else if(r){var g=r.value.match(/\s*$/)[0],y=e.value.match(/^\s*/)[0],h=le(g,y);e.value=x(e.value,h)}}var Je=new w;Je.tokenize=function(r){var e=new RegExp("(\\r?\\n)|[".concat(A,"]+|[^\\S\\n\\r]+|[^").concat(A,"]"),"ug");return r.match(e)||[]};var Z=new w;Z.tokenize=function(r,e){e.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));var t=[],s=r.split(/(\n|\r\n)/);s[s.length-1]||s.pop();for(var a=0;a<s.length;a++){var n=s[a];a%2&&!e.newlineIsToken?t[t.length-1]+=n:t.push(n)}return t};Z.equals=function(r,e,t){return t.ignoreWhitespace?((!t.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),w.prototype.equals.call(this,r,e,t)};var Fe=new w;Fe.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ge=new w;Ge.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function V(r){"@babel/helpers - typeof";return V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(r)}var z=new w;z.useLongestToken=!0;z.tokenize=Z.tokenize;z.castInput=function(r,e){var t=e.undefinedReplacement,s=e.stringifyReplacer,a=s===void 0?function(n,i){return typeof i>"u"?t:i}:s;return typeof r=="string"?r:JSON.stringify(B(r,null,null,a),a,"  ")};z.equals=function(r,e,t){return w.prototype.equals.call(z,r.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),t)};function B(r,e,t,s,a){e=e||[],t=t||[],s&&(r=s(a,r));var n;for(n=0;n<e.length;n+=1)if(e[n]===r)return t[n];var i;if(Object.prototype.toString.call(r)==="[object Array]"){for(e.push(r),i=new Array(r.length),t.push(i),n=0;n<r.length;n+=1)i[n]=B(r[n],e,t,s,a);return e.pop(),t.pop(),i}if(r&&r.toJSON&&(r=r.toJSON()),V(r)==="object"&&r!==null){e.push(r),i={},t.push(i);var u=[],o;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&u.push(o);for(u.sort(),n=0;n<u.length;n+=1)o=u[n],i[o]=B(r[o],e,t,s,o);e.pop(),t.pop()}else i=r;return i}var U=new w;U.tokenize=function(r){return r.slice()};U.join=U.removeEmpty=function(r){return r};const T=(...r)=>{};var Y=(r=>(r[r.Unknown=0]="Unknown",r[r.Hard=1]="Hard",r[r.Medium=2]="Medium",r[r.Easy=3]="Easy",r))(Y||{});class He{constructor(e){E(this,"name");E(this,"state",0);E(this,"stateProgress",0);E(this,"time",0);E(this,"rate",(e,t)=>{if(T(`Rating card ${this.name}`),e)switch(T(`Input was wrong, current state: ${Y[this.state]}`),this.state){case 0:this.state=1;break;case 1:this.stateProgress=0;break;case 2:this.stateProgress=0,this.state=1;break}else switch(T(`Input was correct, current state: ${Y[this.state]}`),this.state){case 0:this.state=3;break;case 1:this.stateProgress+=1,this.stateProgress>3&&(this.state=2,this.stateProgress=0);break;case 2:this.stateProgress+=1,this.stateProgress>2&&!t&&(this.state=3,this.stateProgress=0);break}switch(this.state){case 1:this.time=Date.now()+30*1e3;break;case 2:this.time=Date.now()+60*1e3;break}T(`Card ${this.name} time: ${this.time} (${this.time-Date.now()})`)});this.name=e}}var M;class Ve{constructor(){W(this,M,he(void 0));E(this,"cards",[]);E(this,"addCard",e=>{this.cards.push(new He(e))});E(this,"getNextCard",()=>{T(this.cards);const e=this.cards.filter(a=>a.time<=Date.now()&&a.state!==0&&a.state!==3);if(e.length>0){const a=e[Math.floor(Math.random()*e.length)];return this.current=a,T(`Got card ${a.name} from expired list`),a}const t=this.cards.filter(a=>a.state===0);if(t.length>0){const a=t[Math.floor(Math.random()*t.length)];return this.current=a,T(`Got card ${a.name} from unknown list`),a}const s=this.cards.filter(a=>a.state!==3);if(s.length>0){const a=s[Math.floor(Math.random()*s.length)];return this.current=a,T(`Got card ${a.name} from all cards`),a}return this.current=void 0,!1})}get current(){return $(P(this,M))}set current(e){_(P(this,M),me(e))}}M=new WeakMap;var Be=ve('<img class="map svelte-1kpeuij" id="map-marker" alt="">'),Ue=ve('<div id="map-container" class="svelte-1kpeuij"><img class="map svelte-1kpeuij" id="map" alt=""> <!> <form id="form" class="wrong"><input type="text" id="input" autocomplete="off" placeholder="Kirjuta siia nimi" class="svelte-1kpeuij"></form> <p id="hint" class="svelte-1kpeuij"><!></p></div>');function We(r,e){xe(e,!0);const t=new Ve;let s,a,n=he(""),i=!1,u=!1;const o={};e.names.forEach(m=>{t.addCard(m);const g=new Image;g.src=`${se}/maps/${e.path}/${m}.png`,o[m]=g}),ze(()=>{t.getNextCard(),s.focus(),s.addEventListener("blur",()=>{setTimeout(()=>{s.focus()},0)}),a.addEventListener("submit",m=>{if(s.value.length===0||t.current===void 0)return;const g=s.value.trim();if(s.value="",g.toLowerCase()===t.current.name.toLowerCase()){s.style.backgroundColor="#70e071",_(n,""),t.current.rate(u,i),u=!1,i=!1,t.getNextCard();return}const y=Pe(t.current.name,g,{ignoreCase:!0});y.filter(v=>v.added||v.removed).reduce((v,L)=>v+(L.count||0),0)<=2?(i=!0,s.style.backgroundColor="#ffe600",_(n,""),y.forEach(v=>{v.added?_(n,$(n)+`<span style="color: red; white-space: pre;">${v.value}</span>`):v.removed||_(n,$(n)+v.value)}),_(n,$(n)+" -> "),y.forEach(v=>{v.removed?_(n,$(n)+`<span style="color: green; white-space: pre;">${v.value}</span>`):v.added||_(n,$(n)+v.value)})):(s.style.backgroundColor="#f56e6e",!u&&!i?(_(n,t.current.name.charAt(0)+t.current.name.replace(/[^ ]/g,"_").slice(1)),u=!0):_(n,me(t.current.name)))})});var f=Ue(),l=q(f),c=b(l,2);{var k=m=>{var g=Be();te(()=>{var y;return ae(g,"src",(y=o[t.current.name])==null?void 0:y.src)}),S(m,g)};Oe(c,m=>{t.current!==void 0&&m(k)})}var p=b(c,2),d=q(p);ne(d,m=>s=m,()=>s),J(p),ne(p,m=>a=m,()=>a);var C=b(p,2),D=q(C);Ae(D,()=>$(n)),J(C),J(f),te(()=>ae(l,"src",`${se??""}/maps/${e.path??""}/Kaart.png`)),S(r,f),Me()}export{We as M};

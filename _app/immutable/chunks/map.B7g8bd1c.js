var he=Object.defineProperty;var X=r=>{throw TypeError(r)};var de=(r,e,t)=>e in r?he(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var D=(r,e,t)=>de(r,typeof e!="symbol"?e+"":e,t),pe=(r,e,t)=>e.has(r)||X("Cannot "+t);var q=(r,e,t)=>(pe(r,e,"read from private field"),t?t.call(r):e.get(r)),j=(r,e,t)=>e.has(r)?X("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{b as W,d as ge,a as K,t as ce}from"./disclose-version.qs4zpThI.js";import{a5 as Ce,f as ye,h as S,I as ee,i as we,m as re,C as Ee,K as ke,D as _e,G as Te,B as De,k as Le,ae as ve,Z as I,W as k,p as $e,u as Ie,ab as te,q as xe,d as J,s as G,r as F}from"./runtime.DzlGlrzq.js";import{p as me,i as ze,b as ne}from"./this.W-5PZNF2.js";import{s as ae}from"./attributes.DHeyF31X.js";import{b as se}from"./paths.u5pIrKPR.js";function Oe(r,e){{const t=document.body;r.autofocus=!0,Ce(()=>{document.activeElement===t&&r.focus()})}}function Ae(r,e,t,n,a){var s=r,i="",u;ye(()=>{if(i===(i=e()??"")){S&&ee();return}u!==void 0&&(Le(u),u=void 0),i!==""&&(u=we(()=>{if(S){re.data;for(var o=ee(),c=o;o!==null&&(o.nodeType!==8||o.data!=="");)c=o,o=Ee(o);if(o===null)throw ke(),_e;W(re,c),s=Te(o);return}var l=i+"",v=ge(l);W(De(v),v.lastChild),s.before(v)}))})}function y(){}y.prototype={diff:function(e,t){var n,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=a.callback;typeof a=="function"&&(s=a,a={});var i=this;function u(f){return f=i.postProcess(f,a),s?(setTimeout(function(){s(f)},0),!0):f}e=this.castInput(e,a),t=this.castInput(t,a),e=this.removeEmpty(this.tokenize(e,a)),t=this.removeEmpty(this.tokenize(t,a));var o=t.length,c=e.length,l=1,v=o+c;a.maxEditLength!=null&&(v=Math.min(v,a.maxEditLength));var w=(n=a.timeout)!==null&&n!==void 0?n:1/0,E=Date.now()+w,h=[{oldPos:-1,lastComponent:void 0}],g=this.extractCommon(h[0],t,e,0,a);if(h[0].oldPos+1>=c&&g+1>=o)return u(ie(i,h[0].lastComponent,t,e,i.useLongestToken));var T=-1/0,$=1/0;function d(){for(var f=Math.max(T,-l);f<=Math.min($,l);f+=2){var C=void 0,_=h[f-1],x=h[f+1];_&&(h[f-1]=void 0);var m=!1;if(x){var M=x.oldPos-f;m=x&&0<=M&&M<o}var Q=_&&_.oldPos+1<c;if(!m&&!Q){h[f]=void 0;continue}if(!Q||m&&_.oldPos<x.oldPos?C=i.addToPath(x,!0,!1,0,a):C=i.addToPath(_,!1,!0,1,a),g=i.extractCommon(C,t,e,f,a),C.oldPos+1>=c&&g+1>=o)return u(ie(i,C.lastComponent,t,e,i.useLongestToken));h[f]=C,C.oldPos+1>=c&&($=Math.min($,f-1)),g+1>=o&&(T=Math.max(T,f+1))}l++}if(s)(function f(){setTimeout(function(){if(l>v||Date.now()>E)return s();d()||f()},0)})();else for(;l<=v&&Date.now()<=E;){var p=d();if(p)return p}},addToPath:function(e,t,n,a,s){var i=e.lastComponent;return i&&!s.oneChangePerToken&&i.added===t&&i.removed===n?{oldPos:e.oldPos+a,lastComponent:{count:i.count+1,added:t,removed:n,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+a,lastComponent:{count:1,added:t,removed:n,previousComponent:i}}},extractCommon:function(e,t,n,a,s){for(var i=t.length,u=n.length,o=e.oldPos,c=o-a,l=0;c+1<i&&o+1<u&&this.equals(n[o+1],t[c+1],s);)c++,o++,l++,s.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return l&&!s.oneChangePerToken&&(e.lastComponent={count:l,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=o,c},equals:function(e,t,n){return n.comparator?n.comparator(e,t):e===t||n.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ie(r,e,t,n,a){for(var s=[],i;e;)s.push(e),i=e.previousComponent,delete e.previousComponent,e=i;s.reverse();for(var u=0,o=s.length,c=0,l=0;u<o;u++){var v=s[u];if(v.removed)v.value=r.join(n.slice(l,l+v.count)),l+=v.count;else{if(!v.added&&a){var w=t.slice(c,c+v.count);w=w.map(function(E,h){var g=n[l+h];return g.length>E.length?g:E}),v.value=r.join(w)}else v.value=r.join(t.slice(c,c+v.count));c+=v.count,v.added||(l+=v.count)}}return s}var Me=new y;function Ne(r,e,t){return Me.diff(r,e,t)}function oe(r,e){var t;for(t=0;t<r.length&&t<e.length;t++)if(r[t]!=e[t])return r.slice(0,t);return r.slice(0,t)}function ue(r,e){var t;if(!r||!e||r[r.length-1]!=e[e.length-1])return"";for(t=0;t<r.length&&t<e.length;t++)if(r[r.length-(t+1)]!=e[e.length-(t+1)])return r.slice(-t);return r.slice(-t)}function H(r,e,t){if(r.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return t+r.slice(e.length)}function U(r,e,t){if(!e)return r+t;if(r.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return r.slice(0,-e.length)+t}function z(r,e){return H(r,e,"")}function N(r,e){return U(r,e,"")}function le(r,e){return e.slice(0,be(r,e))}function be(r,e){var t=0;r.length>e.length&&(t=r.length-e.length);var n=e.length;r.length<e.length&&(n=r.length);var a=Array(n),s=0;a[0]=0;for(var i=1;i<n;i++){for(e[i]==e[s]?a[i]=a[s]:a[i]=s;s>0&&e[i]!=e[s];)s=a[s];e[i]==e[s]&&s++}s=0;for(var u=t;u<r.length;u++){for(;s>0&&r[u]!=e[s];)s=a[s];r[u]==e[s]&&s++}return s}var b="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Re=new RegExp("[".concat(b,"]+|\\s+|[^").concat(b,"]"),"ug"),R=new y;R.equals=function(r,e,t){return t.ignoreCase&&(r=r.toLowerCase(),e=e.toLowerCase()),r.trim()===e.trim()};R.tokenize=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(e.intlSegmenter.segment(r),function(s){return s.segment})}else t=r.match(Re)||[];var n=[],a=null;return t.forEach(function(s){/\s/.test(s)?a==null?n.push(s):n.push(n.pop()+s):/\s/.test(a)?n[n.length-1]==a?n.push(n.pop()+s):n.push(a+s):n.push(s),a=s}),n};R.join=function(r){return r.map(function(e,t){return t==0?e:e.replace(/^\s+/,"")}).join("")};R.postProcess=function(r,e){if(!r||e.oneChangePerToken)return r;var t=null,n=null,a=null;return r.forEach(function(s){s.added?n=s:s.removed?a=s:((n||a)&&fe(t,a,n,s),t=s,n=null,a=null)}),(n||a)&&fe(t,a,n,null),r};function fe(r,e,t,n){if(e&&t){var a=e.value.match(/^\s*/)[0],s=e.value.match(/\s*$/)[0],i=t.value.match(/^\s*/)[0],u=t.value.match(/\s*$/)[0];if(r){var o=oe(a,i);r.value=U(r.value,i,o),e.value=z(e.value,o),t.value=z(t.value,o)}if(n){var c=ue(s,u);n.value=H(n.value,u,c),e.value=N(e.value,c),t.value=N(t.value,c)}}else if(t)r&&(t.value=t.value.replace(/^\s*/,"")),n&&(n.value=n.value.replace(/^\s*/,""));else if(r&&n){var l=n.value.match(/^\s*/)[0],v=e.value.match(/^\s*/)[0],w=e.value.match(/\s*$/)[0],E=oe(l,v);e.value=z(e.value,E);var h=ue(z(l,E),w);e.value=N(e.value,h),n.value=H(n.value,l,h),r.value=U(r.value,l,l.slice(0,l.length-h.length))}else if(n){var g=n.value.match(/^\s*/)[0],T=e.value.match(/\s*$/)[0],$=le(T,g);e.value=N(e.value,$)}else if(r){var d=r.value.match(/\s*$/)[0],p=e.value.match(/^\s*/)[0],f=le(d,p);e.value=z(e.value,f)}}var qe=new y;qe.tokenize=function(r){var e=new RegExp("(\\r?\\n)|[".concat(b,"]+|[^\\S\\n\\r]+|[^").concat(b,"]"),"ug");return r.match(e)||[]};var P=new y;P.tokenize=function(r,e){e.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));var t=[],n=r.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var a=0;a<n.length;a++){var s=n[a];a%2&&!e.newlineIsToken?t[t.length-1]+=s:t.push(s)}return t};P.equals=function(r,e,t){return t.ignoreWhitespace?((!t.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),y.prototype.equals.call(this,r,e,t)};var Je=new y;Je.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ge=new y;Ge.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function B(r){"@babel/helpers - typeof";return B=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(r)}var O=new y;O.useLongestToken=!0;O.tokenize=P.tokenize;O.castInput=function(r,e){var t=e.undefinedReplacement,n=e.stringifyReplacer,a=n===void 0?function(s,i){return typeof i>"u"?t:i}:n;return typeof r=="string"?r:JSON.stringify(V(r,null,null,a),a,"  ")};O.equals=function(r,e,t){return y.prototype.equals.call(O,r.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),t)};function V(r,e,t,n,a){e=e||[],t=t||[],n&&(r=n(a,r));var s;for(s=0;s<e.length;s+=1)if(e[s]===r)return t[s];var i;if(Object.prototype.toString.call(r)==="[object Array]"){for(e.push(r),i=new Array(r.length),t.push(i),s=0;s<r.length;s+=1)i[s]=V(r[s],e,t,n,a);return e.pop(),t.pop(),i}if(r&&r.toJSON&&(r=r.toJSON()),B(r)==="object"&&r!==null){e.push(r),i={},t.push(i);var u=[],o;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&u.push(o);for(u.sort(),s=0;s<u.length;s+=1)o=u[s],i[o]=V(r[o],e,t,n,o);e.pop(),t.pop()}else i=r;return i}var Z=new y;Z.tokenize=function(r){return r.slice()};Z.join=Z.removeEmpty=function(r){return r};const L=(...r)=>{};var Y=(r=>(r[r.Unknown=0]="Unknown",r[r.Hard=1]="Hard",r[r.Medium=2]="Medium",r[r.Easy=3]="Easy",r))(Y||{});class Fe{constructor(e){D(this,"name");D(this,"state",0);D(this,"time",0);D(this,"rate",(e,t)=>{if(L(`Rating card ${this.name}`),e)switch(L(`Input was wrong, current state: ${Y[this.state]}`),this.state){case 0:this.state=1;break;case 1:break;case 2:this.state=1;break}else switch(L(`Input was correct, current state: ${Y[this.state]}`),this.state){case 0:this.state=3;break;case 1:this.state=2;break;case 2:t||(this.state=3);break}switch(this.state){case 1:this.time=Date.now()+60*1e3;break;case 2:this.time=Date.now()+120*1e3;break}L(`Card ${this.name} time: ${this.time} (${this.time-Date.now()})`)});this.name=e}}var A;class He{constructor(){j(this,A,ve(void 0));D(this,"cards",[]);D(this,"addCard",e=>{this.cards.push(new Fe(e))});D(this,"getNextCard",()=>{L(this.cards);const e=this.cards.filter(a=>a.time<=Date.now()&&a.state!==0&&a.state!==3);if(e.length>0){const a=e[Math.floor(Math.random()*e.length)];return this.current=a,L(`Got card ${a.name} from expired list`),a}const t=this.cards.filter(a=>a.state===0);if(t.length>0){const a=t[Math.floor(Math.random()*t.length)];return this.current=a,L(`Got card ${a.name} from unknown list`),a}const n=this.cards.filter(a=>a.state!==3);if(n.length>0){const a=n[Math.floor(Math.random()*n.length)];return this.current=a,L(`Got card ${a.name} from all cards`),a}return this.current=void 0,!1})}get current(){return I(q(this,A))}set current(e){k(q(this,A),me(e))}}A=new WeakMap;var Ue=ce('<img class="map svelte-16thupa" id="map-marker" alt="">'),Be=ce('<div id="map-container" class="svelte-16thupa"><img class="map svelte-16thupa" id="map" alt=""> <!> <form id="form"><input type="text" id="input" autocomplete="off" placeholder="Kirjuta siia nimi" class="svelte-16thupa"></form> <p id="hint" class="svelte-16thupa"><!></p></div>');function je(r,e){$e(e,!0);let t=["järv","jõgi","meri","saar","poolsaar","laht","väin"];const n=new He;let a,s,i=ve(""),u=!1,o=!1;const c={};e.names.forEach(d=>{n.addCard(d);const p=new Image;p.src=`${se}/maps/${e.path}/${d}.png`,c[d]=p}),Ie(()=>{n.getNextCard(),a.focus(),a.addEventListener("blur",()=>{setTimeout(()=>{a.focus()},0)}),s.addEventListener("submit",d=>{if(a.value.length===0||n.current===void 0)return;let p=a.value.trim();a.value="";var f=p.toLowerCase().replaceAll("-"," "),C=n.current.name.toLowerCase().replaceAll("-"," ");if(t.forEach(m=>{C.endsWith(m)&&(f=f.replaceAll(` ${m}`,""),C=C.replaceAll(` ${m}`,""))}),f===C){a.style.backgroundColor="#70e071",k(i,""),n.current.rate(o,u),o=!1,u=!1,n.getNextCard();return}const _=Ne(n.current.name,p,{ignoreCase:!0});_.filter(m=>m.added||m.removed).reduce((m,M)=>m+(M.count||0),0)<=2?(u=!0,a.style.backgroundColor="#ffe600",k(i,""),_.forEach(m=>{m.added?k(i,I(i)+`<span style="color: red; white-space: pre;">${m.value}</span>`):m.removed||k(i,I(i)+m.value)}),k(i,I(i)+" -> "),_.forEach(m=>{m.removed?k(i,I(i)+`<span style="color: green; white-space: pre;">${m.value}</span>`):m.added||k(i,I(i)+m.value)})):(a.style.backgroundColor="#f56e6e",!o&&!u?(k(i,n.current.name.charAt(0)+n.current.name.replace(/[^ ]/g,"_").slice(1)),o=!0):k(i,me(n.current.name)))})});var l=Be(),v=J(l),w=G(v,2);{var E=d=>{var p=Ue();te(()=>{var f;return ae(p,"src",(f=c[n.current.name])==null?void 0:f.src)}),K(d,p)};ze(w,d=>{n.current!==void 0&&d(E)})}var h=G(w,2),g=J(h);Oe(g),ne(g,d=>a=d,()=>a),F(h),ne(h,d=>s=d,()=>s);var T=G(h,2),$=J(T);Ae($,()=>I(i)),F(T),F(l),te(()=>ae(v,"src",`${se??""}/maps/${e.path??""}/Kaart.png`)),K(r,l),xe()}export{je as M};

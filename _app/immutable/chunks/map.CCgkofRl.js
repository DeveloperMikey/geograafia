var he=Object.defineProperty;var X=t=>{throw TypeError(t)};var de=(t,e,r)=>e in t?he(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var _=(t,e,r)=>de(t,typeof e!="symbol"?e+"":e,r),pe=(t,e,r)=>e.has(t)||X("Cannot "+r);var b=(t,e,r)=>(pe(t,e,"read from private field"),r?r.call(t):e.get(t)),j=(t,e,r)=>e.has(t)?X("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r);import{b as W,d as ge,a as K,t as ce}from"./disclose-version.DwCDSX5Q.js";import{a2 as Ce,d as ye,h as S,D as ee,i as we,k as te,z as ke,G as Ee,A as _e,C as Te,y as De,j as Le,ad as ve,W as $,T as k,p as $e,u as Ie,a8 as re,m as ze,a9 as q,s as P,aa as J}from"./runtime.D6dthrJq.js";import{p as me,i as xe,b as ne}from"./this.C8ZYS4mz.js";import{s as ae}from"./attributes.C9amQwmR.js";import{b as se}from"./paths.DBYKYu4v.js";function Oe(t,e){{const r=document.body;t.autofocus=!0,Ce(()=>{document.activeElement===r&&t.focus()})}}function Me(t,e,r,a,s){var n=t,i="",u;ye(()=>{if(i===(i=e()??"")){S&&ee();return}u!==void 0&&(Le(u),u=void 0),i!==""&&(u=we(()=>{if(S){te.data;for(var o=ee(),l=o;o!==null&&(o.nodeType!==8||o.data!=="");)l=o,o=ke(o);if(o===null)throw Ee(),_e;W(te,l),n=Te(o);return}var f=i+"",c=ge(f);W(De(c),c.lastChild),n.before(c)}))})}function w(){}w.prototype={diff:function(e,r){var a,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=s.callback;typeof s=="function"&&(n=s,s={});var i=this;function u(m){return m=i.postProcess(m,s),n?(setTimeout(function(){n(m)},0),!0):m}e=this.castInput(e,s),r=this.castInput(r,s),e=this.removeEmpty(this.tokenize(e,s)),r=this.removeEmpty(this.tokenize(r,s));var o=r.length,l=e.length,f=1,c=o+l;s.maxEditLength!=null&&(c=Math.min(c,s.maxEditLength));var E=(a=s.timeout)!==null&&a!==void 0?a:1/0,p=Date.now()+E,d=[{oldPos:-1,lastComponent:void 0}],C=this.extractCommon(d[0],r,e,0,s);if(d[0].oldPos+1>=l&&C+1>=o)return u(ie(i,d[0].lastComponent,r,e,i.useLongestToken));var D=-1/0,h=1/0;function g(){for(var m=Math.max(D,-f);m<=Math.min(h,f);m+=2){var v=void 0,L=d[m-1],I=d[m+1];L&&(d[m-1]=void 0);var R=!1;if(I){var Z=I.oldPos-m;R=I&&0<=Z&&Z<o}var Q=L&&L.oldPos+1<l;if(!R&&!Q){d[m]=void 0;continue}if(!Q||R&&L.oldPos<I.oldPos?v=i.addToPath(I,!0,!1,0,s):v=i.addToPath(L,!1,!0,1,s),C=i.extractCommon(v,r,e,m,s),v.oldPos+1>=l&&C+1>=o)return u(ie(i,v.lastComponent,r,e,i.useLongestToken));d[m]=v,v.oldPos+1>=l&&(h=Math.min(h,m-1)),C+1>=o&&(D=Math.max(D,m+1))}f++}if(n)(function m(){setTimeout(function(){if(f>c||Date.now()>p)return n();g()||m()},0)})();else for(;f<=c&&Date.now()<=p;){var y=g();if(y)return y}},addToPath:function(e,r,a,s,n){var i=e.lastComponent;return i&&!n.oneChangePerToken&&i.added===r&&i.removed===a?{oldPos:e.oldPos+s,lastComponent:{count:i.count+1,added:r,removed:a,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+s,lastComponent:{count:1,added:r,removed:a,previousComponent:i}}},extractCommon:function(e,r,a,s,n){for(var i=r.length,u=a.length,o=e.oldPos,l=o-s,f=0;l+1<i&&o+1<u&&this.equals(a[o+1],r[l+1],n);)l++,o++,f++,n.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!n.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=o,l},equals:function(e,r,a){return a.comparator?a.comparator(e,r):e===r||a.ignoreCase&&e.toLowerCase()===r.toLowerCase()},removeEmpty:function(e){for(var r=[],a=0;a<e.length;a++)e[a]&&r.push(e[a]);return r},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ie(t,e,r,a,s){for(var n=[],i;e;)n.push(e),i=e.previousComponent,delete e.previousComponent,e=i;n.reverse();for(var u=0,o=n.length,l=0,f=0;u<o;u++){var c=n[u];if(c.removed)c.value=t.join(a.slice(f,f+c.count)),f+=c.count;else{if(!c.added&&s){var E=r.slice(l,l+c.count);E=E.map(function(p,d){var C=a[f+d];return C.length>p.length?C:p}),c.value=t.join(E)}else c.value=t.join(r.slice(l,l+c.count));l+=c.count,c.added||(f+=c.count)}}return n}var Ne=new w;function Ae(t,e,r){return Ne.diff(t,e,r)}function oe(t,e){var r;for(r=0;r<t.length&&r<e.length;r++)if(t[r]!=e[r])return t.slice(0,r);return t.slice(0,r)}function ue(t,e){var r;if(!t||!e||t[t.length-1]!=e[e.length-1])return"";for(r=0;r<t.length&&r<e.length;r++)if(t[t.length-(r+1)]!=e[e.length-(r+1)])return t.slice(-r);return t.slice(-r)}function G(t,e,r){if(t.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return r+t.slice(e.length)}function F(t,e,r){if(!e)return t+r;if(t.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(t)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return t.slice(0,-e.length)+r}function z(t,e){return G(t,e,"")}function M(t,e){return F(t,e,"")}function le(t,e){return e.slice(0,Re(t,e))}function Re(t,e){var r=0;t.length>e.length&&(r=t.length-e.length);var a=e.length;t.length<e.length&&(a=t.length);var s=Array(a),n=0;s[0]=0;for(var i=1;i<a;i++){for(e[i]==e[n]?s[i]=s[n]:s[i]=n;n>0&&e[i]!=e[n];)n=s[n];e[i]==e[n]&&n++}n=0;for(var u=r;u<t.length;u++){for(;n>0&&t[u]!=e[n];)n=s[n];t[u]==e[n]&&n++}return n}var N="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",be=new RegExp("[".concat(N,"]+|\\s+|[^").concat(N,"]"),"ug"),A=new w;A.equals=function(t,e,r){return r.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t.trim()===e.trim()};A.tokenize=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');r=Array.from(e.intlSegmenter.segment(t),function(n){return n.segment})}else r=t.match(be)||[];var a=[],s=null;return r.forEach(function(n){/\s/.test(n)?s==null?a.push(n):a.push(a.pop()+n):/\s/.test(s)?a[a.length-1]==s?a.push(a.pop()+n):a.push(s+n):a.push(n),s=n}),a};A.join=function(t){return t.map(function(e,r){return r==0?e:e.replace(/^\s+/,"")}).join("")};A.postProcess=function(t,e){if(!t||e.oneChangePerToken)return t;var r=null,a=null,s=null;return t.forEach(function(n){n.added?a=n:n.removed?s=n:((a||s)&&fe(r,s,a,n),r=n,a=null,s=null)}),(a||s)&&fe(r,s,a,null),t};function fe(t,e,r,a){if(e&&r){var s=e.value.match(/^\s*/)[0],n=e.value.match(/\s*$/)[0],i=r.value.match(/^\s*/)[0],u=r.value.match(/\s*$/)[0];if(t){var o=oe(s,i);t.value=F(t.value,i,o),e.value=z(e.value,o),r.value=z(r.value,o)}if(a){var l=ue(n,u);a.value=G(a.value,u,l),e.value=M(e.value,l),r.value=M(r.value,l)}}else if(r)t&&(r.value=r.value.replace(/^\s*/,"")),a&&(a.value=a.value.replace(/^\s*/,""));else if(t&&a){var f=a.value.match(/^\s*/)[0],c=e.value.match(/^\s*/)[0],E=e.value.match(/\s*$/)[0],p=oe(f,c);e.value=z(e.value,p);var d=ue(z(f,p),E);e.value=M(e.value,d),a.value=G(a.value,f,d),t.value=F(t.value,f,f.slice(0,f.length-d.length))}else if(a){var C=a.value.match(/^\s*/)[0],D=e.value.match(/\s*$/)[0],h=le(D,C);e.value=M(e.value,h)}else if(t){var g=t.value.match(/\s*$/)[0],y=e.value.match(/^\s*/)[0],m=le(g,y);e.value=z(e.value,m)}}var qe=new w;qe.tokenize=function(t){var e=new RegExp("(\\r?\\n)|[".concat(N,"]+|[^\\S\\n\\r]+|[^").concat(N,"]"),"ug");return t.match(e)||[]};var Y=new w;Y.tokenize=function(t,e){e.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var r=[],a=t.split(/(\n|\r\n)/);a[a.length-1]||a.pop();for(var s=0;s<a.length;s++){var n=a[s];s%2&&!e.newlineIsToken?r[r.length-1]+=n:r.push(n)}return r};Y.equals=function(t,e,r){return r.ignoreWhitespace?((!r.newlineIsToken||!t.includes(`
`))&&(t=t.trim()),(!r.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):r.ignoreNewlineAtEof&&!r.newlineIsToken&&(t.endsWith(`
`)&&(t=t.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),w.prototype.equals.call(this,t,e,r)};var Pe=new w;Pe.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Je=new w;Je.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function H(t){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(t)}var x=new w;x.useLongestToken=!0;x.tokenize=Y.tokenize;x.castInput=function(t,e){var r=e.undefinedReplacement,a=e.stringifyReplacer,s=a===void 0?function(n,i){return typeof i>"u"?r:i}:a;return typeof t=="string"?t:JSON.stringify(U(t,null,null,s),s,"  ")};x.equals=function(t,e,r){return w.prototype.equals.call(x,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),r)};function U(t,e,r,a,s){e=e||[],r=r||[],a&&(t=a(s,t));var n;for(n=0;n<e.length;n+=1)if(e[n]===t)return r[n];var i;if(Object.prototype.toString.call(t)==="[object Array]"){for(e.push(t),i=new Array(t.length),r.push(i),n=0;n<t.length;n+=1)i[n]=U(t[n],e,r,a,s);return e.pop(),r.pop(),i}if(t&&t.toJSON&&(t=t.toJSON()),H(t)==="object"&&t!==null){e.push(t),i={},r.push(i);var u=[],o;for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&u.push(o);for(u.sort(),n=0;n<u.length;n+=1)o=u[n],i[o]=U(t[o],e,r,a,o);e.pop(),r.pop()}else i=t;return i}var V=new w;V.tokenize=function(t){return t.slice()};V.join=V.removeEmpty=function(t){return t};const T=(...t)=>{};var B=(t=>(t[t.Unknown=0]="Unknown",t[t.Hard=1]="Hard",t[t.Medium=2]="Medium",t[t.Easy=3]="Easy",t))(B||{});class Ge{constructor(e){_(this,"name");_(this,"state",0);_(this,"stateProgress",0);_(this,"time",0);_(this,"rate",(e,r)=>{if(T(`Rating card ${this.name}`),e)switch(T(`Input was wrong, current state: ${B[this.state]}`),this.state){case 0:this.state=1;break;case 1:this.stateProgress=0;break;case 2:this.stateProgress=0,this.state=1;break}else switch(T(`Input was correct, current state: ${B[this.state]}`),this.state){case 0:this.state=3;break;case 1:this.stateProgress+=1,this.stateProgress>1&&(this.state=2,this.stateProgress=0);break;case 2:this.stateProgress+=1,this.stateProgress>1&&!r&&(this.state=3,this.stateProgress=0);break}switch(this.state){case 1:this.time=Date.now()+30*1e3;break;case 2:this.time=Date.now()+60*1e3;break}T(`Card ${this.name} time: ${this.time} (${this.time-Date.now()})`)});this.name=e}}var O;class Fe{constructor(){j(this,O,ve(void 0));_(this,"cards",[]);_(this,"addCard",e=>{this.cards.push(new Ge(e))});_(this,"getNextCard",()=>{T(this.cards);const e=this.cards.filter(s=>s.time<=Date.now()&&s.state!==0&&s.state!==3);if(e.length>0){const s=e[Math.floor(Math.random()*e.length)];return this.current=s,T(`Got card ${s.name} from expired list`),s}const r=this.cards.filter(s=>s.state===0);if(r.length>0){const s=r[Math.floor(Math.random()*r.length)];return this.current=s,T(`Got card ${s.name} from unknown list`),s}const a=this.cards.filter(s=>s.state!==3);if(a.length>0){const s=a[Math.floor(Math.random()*a.length)];return this.current=s,T(`Got card ${s.name} from all cards`),s}return this.current=void 0,!1})}get current(){return $(b(this,O))}set current(e){k(b(this,O),me(e))}}O=new WeakMap;var He=ce('<img class="map svelte-1kpeuij" id="map-marker" alt="">'),Ue=ce('<div id="map-container" class="svelte-1kpeuij"><img class="map svelte-1kpeuij" id="map" alt=""> <!> <form id="form"><input type="text" id="input" autocomplete="off" placeholder="Kirjuta siia nimi" class="svelte-1kpeuij"></form> <p id="hint" class="svelte-1kpeuij"><!></p></div>');function je(t,e){$e(e,!0);const r=new Fe;let a,s,n=ve(""),i=!1,u=!1;const o={};e.names.forEach(h=>{r.addCard(h);const g=new Image;g.src=`${se}/maps/${e.path}/${h}.png`,o[h]=g}),Ie(()=>{r.getNextCard(),a.focus(),a.addEventListener("blur",()=>{setTimeout(()=>{a.focus()},0)}),s.addEventListener("submit",h=>{if(a.value.length===0||r.current===void 0)return;const g=a.value.trim();if(a.value="",g.toLowerCase()===r.current.name.toLowerCase()){a.style.backgroundColor="#70e071",k(n,""),r.current.rate(u,i),u=!1,i=!1,r.getNextCard();return}const y=Ae(r.current.name,g,{ignoreCase:!0});y.filter(v=>v.added||v.removed).reduce((v,L)=>v+(L.count||0),0)<=2?(i=!0,a.style.backgroundColor="#ffe600",k(n,""),y.forEach(v=>{v.added?k(n,$(n)+`<span style="color: red; white-space: pre;">${v.value}</span>`):v.removed||k(n,$(n)+v.value)}),k(n,$(n)+" -> "),y.forEach(v=>{v.removed?k(n,$(n)+`<span style="color: green; white-space: pre;">${v.value}</span>`):v.added||k(n,$(n)+v.value)})):(a.style.backgroundColor="#f56e6e",!u&&!i?(k(n,r.current.name.charAt(0)+r.current.name.replace(/[^ ]/g,"_").slice(1)),u=!0):k(n,me(r.current.name)))})});var l=Ue(),f=q(l),c=P(f,2);{var E=h=>{var g=He();re(()=>{var y;return ae(g,"src",(y=o[r.current.name])==null?void 0:y.src)}),K(h,g)};xe(c,h=>{r.current!==void 0&&h(E)})}var p=P(c,2),d=q(p);Oe(d),ne(d,h=>a=h,()=>a),J(p),ne(p,h=>s=h,()=>s);var C=P(p,2),D=q(C);Me(D,()=>$(n)),J(C),J(l),re(()=>ae(f,"src",`${se??""}/maps/${e.path??""}/Kaart.png`)),K(t,l),ze()}export{je as M};

var ye=Object.defineProperty;var re=r=>{throw TypeError(r)};var Ce=(r,e,t)=>e in r?ye(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var $=(r,e,t)=>Ce(r,typeof e!="symbol"?e+"":e,t),we=(r,e,t)=>e.has(r)||re("Cannot "+t);var H=(r,e,t)=>(we(r,e,"read from private field"),t?t.call(r):e.get(r)),te=(r,e,t)=>e.has(r)?re("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,t);import{a as ne,e as _e,b as V,t as S}from"./disclose-version.gJPiqUN0.js";import{a1 as ke,h as Ee,i as ae,j as ie,n as ze,o as se,F as Te,J as Le,G as De,s as Ne,C as $e,a5 as Ae,am as B,g as A,X as _,P as Ie,a as be,a8 as b,a6 as xe,a7 as oe,Q as Oe,a9 as O,aa as M}from"./runtime.B4NV5RgZ.js";import{d as Me}from"./events.BqsYov0_.js";import{i as ue}from"./if.CUwVhyxT.js";import{a as le}from"./landforms.BB7uQoVy.js";import{p as pe,b as fe}from"./this.Db2o3wFT.js";import{b as Q}from"./paths.DSM9VWFz.js";function Re(r,e){{const t=document.body;r.autofocus=!0,ke(()=>{document.activeElement===t&&r.focus()})}}function Pe(r,e,t,n,i){var a=r,s="",o;Ee(()=>{if(s===(s=e()??"")){ae&&ie();return}o!==void 0&&(Ae(o),o=void 0),s!==""&&(o=ze(()=>{if(ae){se.data;for(var u=ie(),l=u;u!==null&&(u.nodeType!==8||u.data!=="");)l=u,u=Te(u);if(u===null)throw Le(),De;ne(se,l),a=Ne(u);return}var f=s+"",c=_e(f);ne($e(c),c.lastChild),a.before(c)}))})}function k(){}k.prototype={diff:function(e,t){var n,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=i.callback;typeof i=="function"&&(a=i,i={});var s=this;function o(v){return v=s.postProcess(v,i),a?(setTimeout(function(){a(v)},0),!0):v}e=this.castInput(e,i),t=this.castInput(t,i),e=this.removeEmpty(this.tokenize(e,i)),t=this.removeEmpty(this.tokenize(t,i));var u=t.length,l=e.length,f=1,c=u+l;i.maxEditLength!=null&&(c=Math.min(c,i.maxEditLength));var y=(n=i.timeout)!==null&&n!==void 0?n:1/0,C=Date.now()+y,p=[{oldPos:-1,lastComponent:void 0}],w=this.extractCommon(p[0],t,e,0,i);if(p[0].oldPos+1>=l&&w+1>=u)return o(ce(s,p[0].lastComponent,t,e,s.useLongestToken));var E=-1/0,N=1/0;function I(){for(var v=Math.max(E,-f);v<=Math.min(N,f);v+=2){var T=void 0,m=p[v-1],g=p[v+1];m&&(p[v-1]=void 0);var d=!1;if(g){var z=g.oldPos-v;d=g&&0<=z&&z<u}var L=m&&m.oldPos+1<l;if(!d&&!L){p[v]=void 0;continue}if(!L||d&&m.oldPos<g.oldPos?T=s.addToPath(g,!0,!1,0,i):T=s.addToPath(m,!1,!0,1,i),w=s.extractCommon(T,t,e,v,i),T.oldPos+1>=l&&w+1>=u)return o(ce(s,T.lastComponent,t,e,s.useLongestToken));p[v]=T,T.oldPos+1>=l&&(N=Math.min(N,v-1)),w+1>=u&&(E=Math.max(E,v+1))}f++}if(a)(function v(){setTimeout(function(){if(f>c||Date.now()>C)return a();I()||v()},0)})();else for(;f<=c&&Date.now()<=C;){var x=I();if(x)return x}},addToPath:function(e,t,n,i,a){var s=e.lastComponent;return s&&!a.oneChangePerToken&&s.added===t&&s.removed===n?{oldPos:e.oldPos+i,lastComponent:{count:s.count+1,added:t,removed:n,previousComponent:s.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:t,removed:n,previousComponent:s}}},extractCommon:function(e,t,n,i,a){for(var s=t.length,o=n.length,u=e.oldPos,l=u-i,f=0;l+1<s&&u+1<o&&this.equals(n[u+1],t[l+1],a);)l++,u++,f++,a.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return f&&!a.oneChangePerToken&&(e.lastComponent={count:f,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,l},equals:function(e,t,n){return n.comparator?n.comparator(e,t):e===t||n.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],n=0;n<e.length;n++)e[n]&&t.push(e[n]);return t},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ce(r,e,t,n,i){for(var a=[],s;e;)a.push(e),s=e.previousComponent,delete e.previousComponent,e=s;a.reverse();for(var o=0,u=a.length,l=0,f=0;o<u;o++){var c=a[o];if(c.removed)c.value=r.join(n.slice(f,f+c.count)),f+=c.count;else{if(!c.added&&i){var y=t.slice(l,l+c.count);y=y.map(function(C,p){var w=n[f+p];return w.length>C.length?w:C}),c.value=r.join(y)}else c.value=r.join(t.slice(l,l+c.count));l+=c.count,c.added||(f+=c.count)}}return a}var qe=new k;function Je(r,e,t){return qe.diff(r,e,t)}function ve(r,e){var t;for(t=0;t<r.length&&t<e.length;t++)if(r[t]!=e[t])return r.slice(0,t);return r.slice(0,t)}function me(r,e){var t;if(!r||!e||r[r.length-1]!=e[e.length-1])return"";for(t=0;t<r.length&&t<e.length;t++)if(r[r.length-(t+1)]!=e[e.length-(t+1)])return r.slice(-t);return r.slice(-t)}function X(r,e,t){if(r.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return t+r.slice(e.length)}function Y(r,e,t){if(!e)return r+t;if(r.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(r)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return r.slice(0,-e.length)+t}function R(r,e){return X(r,e,"")}function J(r,e){return Y(r,e,"")}function he(r,e){return e.slice(0,Fe(r,e))}function Fe(r,e){var t=0;r.length>e.length&&(t=r.length-e.length);var n=e.length;r.length<e.length&&(n=r.length);var i=Array(n),a=0;i[0]=0;for(var s=1;s<n;s++){for(e[s]==e[a]?i[s]=i[a]:i[s]=a;a>0&&e[s]!=e[a];)a=i[a];e[s]==e[a]&&a++}a=0;for(var o=t;o<r.length;o++){for(;a>0&&r[o]!=e[a];)a=i[a];r[o]==e[a]&&a++}return a}var F="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",Ge=new RegExp("[".concat(F,"]+|\\s+|[^").concat(F,"]"),"ug"),G=new k;G.equals=function(r,e,t){return t.ignoreCase&&(r=r.toLowerCase(),e=e.toLowerCase()),r.trim()===e.trim()};G.tokenize=function(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(e.intlSegmenter.segment(r),function(a){return a.segment})}else t=r.match(Ge)||[];var n=[],i=null;return t.forEach(function(a){/\s/.test(a)?i==null?n.push(a):n.push(n.pop()+a):/\s/.test(i)?n[n.length-1]==i?n.push(n.pop()+a):n.push(i+a):n.push(a),i=a}),n};G.join=function(r){return r.map(function(e,t){return t==0?e:e.replace(/^\s+/,"")}).join("")};G.postProcess=function(r,e){if(!r||e.oneChangePerToken)return r;var t=null,n=null,i=null;return r.forEach(function(a){a.added?n=a:a.removed?i=a:((n||i)&&de(t,i,n,a),t=a,n=null,i=null)}),(n||i)&&de(t,i,n,null),r};function de(r,e,t,n){if(e&&t){var i=e.value.match(/^\s*/)[0],a=e.value.match(/\s*$/)[0],s=t.value.match(/^\s*/)[0],o=t.value.match(/\s*$/)[0];if(r){var u=ve(i,s);r.value=Y(r.value,s,u),e.value=R(e.value,u),t.value=R(t.value,u)}if(n){var l=me(a,o);n.value=X(n.value,o,l),e.value=J(e.value,l),t.value=J(t.value,l)}}else if(t)r&&(t.value=t.value.replace(/^\s*/,"")),n&&(n.value=n.value.replace(/^\s*/,""));else if(r&&n){var f=n.value.match(/^\s*/)[0],c=e.value.match(/^\s*/)[0],y=e.value.match(/\s*$/)[0],C=ve(f,c);e.value=R(e.value,C);var p=me(R(f,C),y);e.value=J(e.value,p),n.value=X(n.value,f,p),r.value=Y(r.value,f,f.slice(0,f.length-p.length))}else if(n){var w=n.value.match(/^\s*/)[0],E=e.value.match(/\s*$/)[0],N=he(E,w);e.value=J(e.value,N)}else if(r){var I=r.value.match(/\s*$/)[0],x=e.value.match(/^\s*/)[0],v=he(I,x);e.value=R(e.value,v)}}var Ue=new k;Ue.tokenize=function(r){var e=new RegExp("(\\r?\\n)|[".concat(F,"]+|[^\\S\\n\\r]+|[^").concat(F,"]"),"ug");return r.match(e)||[]};var ee=new k;ee.tokenize=function(r,e){e.stripTrailingCr&&(r=r.replace(/\r\n/g,`
`));var t=[],n=r.split(/(\n|\r\n)/);n[n.length-1]||n.pop();for(var i=0;i<n.length;i++){var a=n[i];i%2&&!e.newlineIsToken?t[t.length-1]+=a:t.push(a)}return t};ee.equals=function(r,e,t){return t.ignoreWhitespace?((!t.newlineIsToken||!r.includes(`
`))&&(r=r.trim()),(!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(r.endsWith(`
`)&&(r=r.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),k.prototype.equals.call(this,r,e,t)};var He=new k;He.tokenize=function(r){return r.split(/(\S.+?[.!?])(?=\s+|$)/)};var Ve=new k;Ve.tokenize=function(r){return r.split(/([{}:;,]|\s+)/)};function Z(r){"@babel/helpers - typeof";return Z=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(r)}var P=new k;P.useLongestToken=!0;P.tokenize=ee.tokenize;P.castInput=function(r,e){var t=e.undefinedReplacement,n=e.stringifyReplacer,i=n===void 0?function(a,s){return typeof s>"u"?t:s}:n;return typeof r=="string"?r:JSON.stringify(j(r,null,null,i),i,"  ")};P.equals=function(r,e,t){return k.prototype.equals.call(P,r.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),t)};function j(r,e,t,n,i){e=e||[],t=t||[],n&&(r=n(i,r));var a;for(a=0;a<e.length;a+=1)if(e[a]===r)return t[a];var s;if(Object.prototype.toString.call(r)==="[object Array]"){for(e.push(r),s=new Array(r.length),t.push(s),a=0;a<r.length;a+=1)s[a]=j(r[a],e,t,n,i);return e.pop(),t.pop(),s}if(r&&r.toJSON&&(r=r.toJSON()),Z(r)==="object"&&r!==null){e.push(r),s={},t.push(s);var o=[],u;for(u in r)Object.prototype.hasOwnProperty.call(r,u)&&o.push(u);for(o.sort(),a=0;a<o.length;a+=1)u=o[a],s[u]=j(r[u],e,t,n,u);e.pop(),t.pop()}else s=r;return s}var W=new k;W.tokenize=function(r){return r.slice()};W.join=W.removeEmpty=function(r){return r};const D=(...r)=>{console.log(...r)};var K=(r=>(r[r.Unknown=0]="Unknown",r[r.Hard=1]="Hard",r[r.Medium=2]="Medium",r[r.Easy=3]="Easy",r))(K||{});class Be{constructor(e){$(this,"name");$(this,"state",0);$(this,"time",0);$(this,"rate",(e,t)=>{if(D(`Rating card ${this.name}`),e)switch(D(`Input was wrong, current state: ${K[this.state]}`),this.state){case 0:this.state=1;break;case 1:break;case 2:this.state=1;break}else switch(D(`Input was correct, current state: ${K[this.state]}`),this.state){case 0:this.state=3;break;case 1:this.state=2;break;case 2:t||(this.state=3);break}switch(this.state){case 1:this.time=Date.now()+60*1e3;break;case 2:this.time=Date.now()+120*1e3;break}D(`Card ${this.name} time: ${this.time} (${this.time-Date.now()})`)});this.name=e}getPrimaryName(){return Array.isArray(this.name)?this.name[0]:this.name}getAllNames(){return Array.isArray(this.name)?this.name:[this.name]}}var q;class Qe{constructor(){te(this,q,B(void 0));$(this,"cards",[]);$(this,"addCard",e=>{const t=new Be(e);return this.cards.push(t),t});$(this,"getNextCard",()=>{D(this.cards);const e=this.cards.filter(i=>i.time<=Date.now()&&i.state!==0&&i.state!==3);if(e.length>0){const i=e[Math.floor(Math.random()*e.length)];return this.current=i,D(`Got card ${i.name} from expired list`),i}const t=this.cards.filter(i=>i.state===0);if(t.length>0){const i=t[Math.floor(Math.random()*t.length)];return this.current=i,D(`Got card ${i.name} from unknown list`),i}const n=this.cards.filter(i=>i.state!==3);if(n.length>0){const i=n[Math.floor(Math.random()*n.length)];return this.current=i,D(`Got card ${i.name} from all cards`),i}return D("Card pack empty, returning false"),this.current=void 0,!1})}get current(){return A(H(this,q))}set current(e){_(H(this,q),pe(e))}}q=new WeakMap;var Xe=S('<img class="map svelte-11p1gzf" id="map-marker" alt="" draggable="false">'),Ye=()=>window.location.href=`${Q}/`,Ze=()=>window.location.reload(),je=S('<div id="end-screen" class="svelte-11p1gzf"><div id="end-box" class="svelte-11p1gzf"><h2 class="svelte-11p1gzf">Tehtud!</h2> <button class="svelte-11p1gzf">Avaleht</button> <button class="svelte-11p1gzf">Uuesti</button></div></div>'),We=S('<head><meta name="viewport" content="width=device-width, initial-scale=1, interactive-widget=resizes-content"></head> <div id="map-container" class="svelte-11p1gzf"><img class="map svelte-11p1gzf" id="map" alt="" draggable="false"> <!> <form id="form"><input type="text" id="input" autocomplete="off" placeholder="Kirjuta siia nimi" class="svelte-11p1gzf"></form> <p id="hint" class="svelte-11p1gzf"><!></p></div> <!>',1);function or(r,e){Ie(e,!0);let t=["järv","jõgi","meri","saar","poolsaar","laht","väin"];const n=new Qe;let i=B(!1),a,s,o=B(""),u=!1,l=!1;const f={};e.names.forEach(m=>{const d=n.addCard(m).getPrimaryName(),z=new Image;z.src=`${Q}/maps/${e.path}/${d}.png`,f[d]=z}),be(()=>{n.getNextCard(),a.focus(),a.addEventListener("blur",()=>{setTimeout(()=>{a.focus()},0)}),s.addEventListener("submit",m=>{if(a.value.length===0||n.current===void 0)return;let g=a.value.trim();a.value="";var d=g.toLowerCase().replaceAll("-"," ");const z=n.current;n.current.getAllNames().forEach(h=>{d=d.replace(h.toLowerCase(),z.getPrimaryName().toLowerCase())});var L=n.current.getPrimaryName().toLowerCase().replaceAll("-"," ");if(t.forEach(h=>{L.endsWith(h)&&(d=d.replaceAll(` ${h}`,""),L=L.replaceAll(` ${h}`,""))}),d===L){a.style.backgroundColor="#70e071",_(o,""),n.current.rate(l,u),l=!1,u=!1,n.getNextCard()||_(i,!0);return}const U=Je(n.current.getPrimaryName(),g,{ignoreCase:!0});U.filter(h=>h.added||h.removed).reduce((h,ge)=>h+(ge.count||0),0)<=2?(u=!0,a.style.backgroundColor="#ffe600",_(o,""),U.forEach(h=>{h.added?_(o,A(o)+`<span style="color: red; white-space: pre;">${h.value}</span>`):h.removed||_(o,A(o)+h.value)}),_(o,A(o)+" -> "),U.forEach(h=>{h.removed?_(o,A(o)+`<span style="color: green; white-space: pre;">${h.value}</span>`):h.added||_(o,A(o)+h.value)})):(a.style.backgroundColor="#f56e6e",!l&&!u?(_(o,n.current.getPrimaryName().charAt(0)+n.current.getPrimaryName().replace(/[^ ]/g,"_").slice(1)),l=!0):_(o,pe(n.current.getPrimaryName())))})});var c=We(),y=b(xe(c),2),C=O(y),p=b(C,2);{var w=m=>{var g=Xe();oe(()=>{var d;return le(g,"src",(d=f[n.current.getPrimaryName()])==null?void 0:d.src)}),V(m,g)};ue(p,m=>{n.current!==void 0&&m(w)})}var E=b(p,2),N=O(E);Re(N),fe(N,m=>a=m,()=>a),M(E),fe(E,m=>s=m,()=>s);var I=b(E,2),x=O(I);Pe(x,()=>A(o)),M(I),M(y);var v=b(y,2);{var T=m=>{var g=je(),d=O(g),z=b(O(d),2);z.__click=[Ye];var L=b(z,2);L.__click=[Ze],M(d),M(g),V(m,g)};ue(v,m=>{A(i)&&m(T)})}oe(()=>le(C,"src",`${Q??""}/maps/${e.path??""}/Kaart.png`)),V(r,c),Oe()}Me(["click"]);export{or as M};
